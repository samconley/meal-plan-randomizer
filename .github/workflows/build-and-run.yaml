name: Run

on:
  push

env:
    FROM_EMAIL: ${{secrets.FROM_EMAIL}}
    EMAIL_PASSWORD: ${{secrets.EMAIL_PASSWORD}}
    TO_LIST: ${{secrets.TO_LIST}}
    SMTP_HOST: ${{secrets.SMTP_HOST}}
    SMTP_HOST_PORT: ${{secrets.SMTP_HOST_PORT}}

jobs:

  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3

    - name: Set up Go
      uses: actions/setup-go@v3
      with:
        go-version: 1.18

    - name: Build
      run: CGO_ENABLED=0 go build -v ./cmd/meal-plan-randomizer
    
    - name: Run
      run: ./meal-plan-randomizer
